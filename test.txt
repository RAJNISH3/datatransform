version: '3'
services:
  zookeeper:
    image: "bitnami/zookeeper"
    environment:
      - ALLOW_ANONYMOUS_LOGIN=yes
    ports:
      - "22181:2181"
  kafka:
    image: "bitnami/kafka"
    environment:
      - KAFKA_CFG_ZOOKEEPER_CONNECT=zookeeper:2181
      - KAFKA_ADVERTISED_HOST_NAME=kafka
      - ALLOW_PLAINTEXT_LISTENER=yes
    ports:
      - "29092:9092"
    depends_on:
      - zookeeper
  spark:
    image: "bitnami/spark"
    environment:
      - SPARK_MODE=master
    ports:
      - "28080:8080"
    volumes:
      - ../Applications/hellospark/target/hellospark-0.0.1-SNAPSHOT-jar-with-dependencies.jar:/usr/apps/hellospark.jar
  spark-worker:
    image: "bitnami/spark"
    environment:
      - SPARK_MODE=worker
      - SPARK_MASTER_URL=spark://spark:7077
    depends_on:
      - spark